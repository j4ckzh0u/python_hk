#author:azure
#time:2019/1/29

import requests
import os
import re
from bs4 import *


xj=open('save.txt','w')
xj.close()

class Fofa:
    def __init__(self,headers,url):
        self.headers=headers
        self.url=url

    def requet(self):
        try:
            rqt=requests.get(url=self.url,headers=self.headers)
            zz=re.findall('<a target="_blank" href=".*">.* <i class="fa fa-link"></i></a>',rqt.text)
            for z in zz:
                href=BeautifulSoup(str(z),'html.parser')
                for q in href.find_all('a'):
                    host=q.get('href')
                    print('[+]IP:'+str(host).replace('http://','').replace('https://','').lstrip())
                    print(str(host).replace('http://', '').replace('https://', '').lstrip(),file=open('save.txt','a'))
        except Exception as r:
            print('[!] Error {}'.format(r))

if __name__ == '__main__':
    headers={'user-agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'}
    url='https://fofa.so/result?qbase64=YXBwPSJjZXJpb19EVDMwME4i'
    obj=Fofa(headers=headers,url=url)
    obj.requet()